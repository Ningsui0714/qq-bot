# QQ Bot

ä¸€ä¸ªåŸºäº C++ å’Œ WebSocket çš„ QQ ç¾¤èŠæœºå™¨äººï¼Œæ”¯æŒå¤šç§äº¤äº’åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ® **çŒœæ•°æ¸¸æˆ**ï¼š@æœºå™¨äººå‘é€"çŒœæ•°"å¯åŠ¨1-100çŒœæ•°å­—æ¸¸æˆ
- ğŸ“š **è¯¾è¡¨ç®¡ç†**ï¼šæ”¯æŒè¯¾è¡¨çš„å¯¼å…¥ã€æŸ¥è¯¢å’Œæ¸…ç©ºåŠŸèƒ½
- ğŸ’¬ **è‡ªåŠ¨å›å¤**ï¼šæ”¯æŒå…³é”®è¯åŒ¹é…è‡ªåŠ¨å›å¤
- ğŸ“ **æ—¥å¿—è®°å½•**ï¼šå®Œå–„çš„æ—¥å¿—ç³»ç»Ÿï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**ï¼šC++17
- **ç½‘ç»œ**ï¼šBoost.Asio + Boost.Beastï¼ˆWebSocketï¼‰
- **JSONè§£æ**ï¼šnlohmann/json
- **ç¼–è¯‘ç¯å¢ƒ**ï¼šVisual Studio 2019/2022ï¼ˆWindowsï¼‰

## ä¾èµ–é¡¹

- [Boost](https://www.boost.org/) - ç”¨äºç½‘ç»œé€šä¿¡
- [nlohmann/json](https://github.com/nlohmann/json) - JSONè§£æåº“
- [NapCat](https://github.com/NapNeko/NapCatQQ) - QQåè®®å®ç°

## é¡¹ç›®ç»“æ„

```
qq-bot/
â”œâ”€â”€ qq-bot/                        # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.cpp                  # ç¨‹åºå…¥å£ï¼ŒWebSocketè¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ config.h                  # é…ç½®æ–‡ä»¶ï¼ˆæœåŠ¡å™¨åœ°å€ã€æœºå™¨äººQQç­‰ï¼‰
â”‚   â”œâ”€â”€ msg_handler.cpp/h         # ç¾¤æ¶ˆæ¯å¤„ç†å™¨
â”‚   â”œâ”€â”€ private_msg_handler.cpp/h # ç§èŠæ¶ˆæ¯å¤„ç†å™¨
â”‚   â”œâ”€â”€ reply_generator.cpp/h     # å›å¤ç”Ÿæˆå™¨ï¼ˆè§„åˆ™å¼•æ“ï¼‰
â”‚   â”œâ”€â”€ guess_number.cpp/h        # çŒœæ•°æ¸¸æˆæ¨¡å—
â”‚   â”œâ”€â”€ schedule.h                # è¯¾è¡¨æ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ schedule_set.cpp          # è¯¾è¡¨è§„åˆ™é›†
â”‚   â”œâ”€â”€ schedule_loader.cpp/h     # è¯¾è¡¨æŒä¹…åŒ–åŠ è½½å™¨
â”‚   â”œâ”€â”€ utils.cpp/h               # å·¥å…·å‡½æ•°ï¼ˆç¼–ç è½¬æ¢ã€æ—¥å¿—ç­‰ï¼‰
â”‚   â”œâ”€â”€ qq-bot.sln                # Visual Studio è§£å†³æ–¹æ¡ˆ
â”‚   â””â”€â”€ qq-bot.vcxproj            # Visual Studio é¡¹ç›®æ–‡ä»¶
â”œâ”€â”€ LICENSE                        # MIT è®¸å¯è¯
â”œâ”€â”€ .gitignore                     # Gitå¿½ç•¥é…ç½®
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

> **æ³¨æ„**ï¼šè¿è¡Œæ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆ `robot_log.txt`ï¼ˆæ—¥å¿—æ–‡ä»¶ï¼‰å’Œ `persistent_schedules.json`ï¼ˆè¯¾è¡¨æŒä¹…åŒ–æ–‡ä»¶ï¼‰ï¼Œè¿™äº›æ–‡ä»¶å·²è¢« .gitignore æ’é™¤ã€‚

## é…ç½®è¯´æ˜

ç¼–è¾‘ `qq-bot/config.h` æ–‡ä»¶ï¼š

```cpp
// WebSocket é…ç½®ï¼ˆNapCat åœ°å€ï¼‰
const char* const WS_HOST = "127.0.0.1";
const char* const WS_PORT = "3001";
const char* const WS_PATH = "/ws";

// æœºå™¨äººé…ç½®
const char* const BOT_QQ = "ä½ çš„æœºå™¨äººQQå·";
```

## ç¼–è¯‘ä¸è¿è¡Œ

### å‰ç½®æ¡ä»¶

1. å®‰è£… Visual Studio 2019 æˆ–æ›´é«˜ç‰ˆæœ¬
2. å®‰è£… vcpkg å¹¶é…ç½® Boost å’Œ nlohmann-json
   ```bash
   vcpkg install boost:x64-windows
   vcpkg install nlohmann-json:x64-windows
   ```

### ç¼–è¯‘æ­¥éª¤

1. å…‹éš†ä»“åº“
   ```bash
   git clone https://github.com/Ningsui0714/qq-bot.git
   ```

2. ä½¿ç”¨ Visual Studio æ‰“å¼€ `qq-bot/qq-bot.sln`

3. é…ç½® vcpkg é›†æˆï¼ˆå¦‚æœªé…ç½®ï¼‰
   ```bash
   vcpkg integrate install
   ```

4. é€‰æ‹© Release/x64 é…ç½®ï¼Œç¼–è¯‘é¡¹ç›®

### è¿è¡Œ

1. ç¡®ä¿ NapCat å·²å¯åŠ¨å¹¶ç›‘å¬ WebSocket ç«¯å£
2. è¿è¡Œç¼–è¯‘åçš„ `qq-bot.exe`

## ä½¿ç”¨è¯´æ˜

### åŸºç¡€å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| @æœºå™¨äºº hello | è¿”å›é—®å€™è¯­ |
| @æœºå™¨äºº ä½ å¥½ | è¿”å›ä¸­æ–‡é—®å€™ |
| @æœºå™¨äºº 1 | è¿”å› trueï¼ˆæµ‹è¯•ç”¨ï¼‰ |

### çŒœæ•°æ¸¸æˆ

1. @æœºå™¨äºº **çŒœæ•°** - å¯åŠ¨æ¸¸æˆï¼ˆèŒƒå›´1-100ï¼‰
2. ç›´æ¥å‘é€æ•°å­— - çŒœæµ‹ç›®æ ‡æ•°å­—
3. @æœºå™¨äºº **é€€å‡º** - é€€å‡ºæ¸¸æˆ

### è¯¾è¡¨ç®¡ç†

1. @æœºå™¨äºº **å¯¼å…¥è¯¾è¡¨** - æŸ¥çœ‹å¯¼å…¥æ ¼å¼
2. å‘é€ `è¯¾ç¨‹å,æ˜ŸæœŸ,å¼€å§‹å‘¨,ç»“æŸå‘¨,å¼€å§‹èŠ‚,ç»“æŸèŠ‚` - å¯¼å…¥è¯¾ç¨‹
   - ç¤ºä¾‹ï¼š`é«˜ç­‰æ•°å­¦,1,1,16,1,2`ï¼ˆæ˜ŸæœŸä¸€ï¼Œç¬¬1-16å‘¨ï¼Œç¬¬1-2èŠ‚ï¼‰
3. @æœºå™¨äºº **æŸ¥è¯¢è¯¾è¡¨** - æŸ¥çœ‹æ‰€æœ‰å·²å¯¼å…¥è¯¾ç¨‹
4. @æœºå™¨äºº **æ¸…ç©ºè¯¾è¡¨** - æ¸…ç©ºæ‰€æœ‰è¯¾ç¨‹

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°çš„å›å¤è§„åˆ™

åœ¨ `reply_generator.cpp` ä¸­æ·»åŠ æ–°è§„åˆ™ï¼š

```cpp
{
    [](const json& msg_data, const std::string& content) {
        return is_at_bot(msg_data) && content == "ä½ çš„å…³é”®è¯";
    },
    [](const std::string& group_id) {
        return "ä½ çš„å›å¤å†…å®¹";
    }
}
```

### æ·»åŠ æ–°çš„æ¸¸æˆæ¨¡å—

1. åˆ›å»ºæ–°çš„ `.cpp/.h` æ–‡ä»¶
2. å®ç° `std::vector<ReplyRule> get_xxx_rules()` å‡½æ•°
3. åœ¨ `msg_handler.cpp` ä¸­è°ƒç”¨è§„åˆ™é›†

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) è®¸å¯è¯ã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è‡´è°¢

- [NapCat](https://github.com/NapNeko/NapCatQQ) - QQåè®®æ”¯æŒ
- [Boost](https://www.boost.org/) - ç½‘ç»œåº“
- [nlohmann/json](https://github.com/nlohmann/json) - JSONåº“
